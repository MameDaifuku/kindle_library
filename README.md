# 概要
kindleアプリが気に入らないので自作した。  
具体的に気に入らないポイントは以下。  

```  
・もう読まないよなーってなった本を非表示にできない。  
・購入日順でソートできない。  
・状態を設定できない。  
　（本単位ならコレクションでできるけどシリーズ単位だとできない）  
```

# 導入方法
①Googleドライブでスプレッドシートを新規作成（ファイル名は任意）  
②スプレッドシートをブラウザで開く  
③スプレッドシートのURLは以下のような感じになっているはず。  
　https://docs.google.com/spreadsheets/d/[スプレッドシートのID]/edit?~~~  
④コード.gsの先頭のSPREAD_SHEET_IDに↑のURLの値をコピペ  
⑤GoogleドライブでAppScriptを新規作成（ファイル名は任意）  
⑥AppScriptプロジェクトでHTMLファイルを作成（ファイル名はリポジトリのファイル名に合わせる）  
⑦ファイルの中身を一通りコピペ  
　（\_js_test.htmlは検証用実装なので不要）  
⑧AppScriptプロジェクトでデプロイを実行  
　種類の選択：ウェブアプリ  
　次のユーザー都市て実行：自分  
　アクセスできるユーザー：自分のみ  
⑨デプロイ後に表示されるURLをブラウザで開く  

# 使い方（※PCでkindleアプリがインストールされていることを前提とする）
## 初回起動時
①kindleアプリを開く  
　（開いた際に本の一覧情報がローカルに保存される）  
②kindleアプリを閉じる  
③AppScriptのURLを開く  
④画面左上の「ファイルを選択」ボタンを押下  
⑤ファイルダイアログで以下を開く  
　C:\Users\[ユーザー名]\AppData\Local\Amazon\Kindle\Cache  
⑥KindleSyncMetadataCache.xmlを選択、処理完了ポップアップが表示されるまで待機  
⑦スプレッドシートを開き、所有している本の情報が保存されていることを確認  
⑧AppScriptのURLを再度開く  
　＞一覧表示される  

## 運用時
### 表示する
・画面にはシリーズ単位で表示される。  
・画像をクリックするとシリーズの本一覧が表示される。  
・購入日順 / 出版日順 を変更すると並び順が変わる。  
・未設定等のチェックボックス（STATUS_TAG）を変更すると表示対象が絞り込まれる。  
・タイトル検索に値を入力すると表示対象が絞り込まれる。  
　タイトル、タイトル読み仮名（カタカナ）によって絞り込まれる。  

### 読む
・本一覧で画像をクリックするとブラウザリーダーに遷移する。  

### 編集する
・画面左上の編集モードにチェックをつけるとシリーズ一覧の画像の下に  
　STATUS_TAGプルダウンが表示される。  
・プルダウンを変更するとスプレッドシートのSTATUS_TAGの値が変更される。  
・プルダウンを変更しても画面表示は（意図的に）同期させていない。  
　AppScriptのURLを開きなおしたタイミングで同期することになる。  
